# v3.0 æ˜Ÿç©¹é“é“é£æ ¼ UI - æŠ€æœ¯å¯è¡Œæ€§è¯„ä¼°æŠ¥å‘Š

> **è¯„ä¼°æ—¥æœŸ**: 2026-02-26  
> **è¯„ä¼°äºº**: Kiro AI  
> **ç›®æ ‡**: è¯„ä¼°å¤šçª—å£æ¶æ„ + æ˜Ÿç©¹é“é“é£æ ¼ UI çš„æŠ€æœ¯å¯è¡Œæ€§

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

**ç»“è®º**: âœ… **æŠ€æœ¯å¯è¡Œï¼Œä½†éœ€è¦é‡å¤§æ¶æ„é‡æ„**

**å…³é”®å‘ç°**:
- å¤šçª—å£ç®¡ç†ï¼šâœ… å¯è¡Œï¼Œéœ€è¦å¼•å…¥ `desktop_multi_window`
- çª—å£ç‰¹æ•ˆï¼šâœ… å¯è¡Œï¼Œ`flutter_acrylic` æ”¯æŒæ¯›ç»ç’ƒæ•ˆæœ
- çŠ¶æ€åŒæ­¥ï¼šâš ï¸ éœ€è¦è®¾è®¡è·¨çª—å£é€šä¿¡æ–¹æ¡ˆ
- æ•°æ®æŒä¹…åŒ–ï¼šâœ… å½“å‰ Hive æ¶æ„å¯å¤ç”¨
- å¹³å°é™åˆ¶ï¼šâœ… å»ºè®®ä¸“æ³¨ Windows å¹³å°

**é¢„ä¼°å·¥ä½œé‡**: 3-4 å‘¨ï¼ˆçº¦ 80-120 å°æ—¶ï¼‰

---

## 1ï¸âƒ£ å¤šçª—å£ç®¡ç† (Multi-window)

### å½“å‰æ¶æ„åˆ†æ

**ç°çŠ¶**:
- ä½¿ç”¨ `window_manager: ^0.3.7`
- ä»…æ”¯æŒå•çª—å£ç®¡ç†ï¼ˆä¸»çª—å£ â†” æ‚¬æµ®çª—åˆ‡æ¢ï¼‰
- å®ç°ä½ç½®ï¼š`lib/core/services/floating_window_service.dart`

**å±€é™æ€§**:
```dart
// å½“å‰åªèƒ½åœ¨åŒä¸€ä¸ªçª—å£ä¸­åˆ‡æ¢å¤§å°å’Œä½ç½®
await windowManager.setSize(floatingSize);  // 280x200
await windowManager.setSize(fullSize);      // 1200x800
```

### v3.0 éœ€æ±‚

**ç›®æ ‡æ¶æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸»çª—å£ (Main Window)                â”‚
â”‚  - å³ä¾§åœé                           â”‚
â”‚  - èœå•ã€è®¾ç½®ã€ç»Ÿè®¡                  â”‚
â”‚  - å°ºå¯¸: 400x800                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åƒç´ æŒ‚ä»¶ (Pixel Widget)             â”‚
â”‚  - å³ä¸‹è§’æ‚¬æµ®                        â”‚
â”‚  - é€æ˜èƒŒæ™¯ + é¼ æ ‡ç©¿é€               â”‚
â”‚  - å°ºå¯¸: 200x200                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ–¹æ¡ˆ

#### æ–¹æ¡ˆ A: desktop_multi_windowï¼ˆæ¨èï¼‰

**ä¾èµ–åŒ…**: `desktop_multi_window: ^0.2.0`

**ä¼˜ç‚¹**:
- âœ… ä¸“ä¸º Flutter æ¡Œé¢è®¾è®¡
- âœ… æ”¯æŒå¤šä¸ªç‹¬ç«‹çª—å£
- âœ… æ¯ä¸ªçª—å£æœ‰ç‹¬ç«‹çš„ Dart isolate
- âœ… æ”¯æŒçª—å£é—´é€šä¿¡

**å®ç°ç¤ºä¾‹**:
```dart
// åˆ›å»ºä¸»çª—å£
final mainWindowId = await DesktopMultiWindow.createWindow(
  jsonEncode({
    'type': 'main_menu',
    'width': 400,
    'height': 800,
  }),
);

// åˆ›å»ºåƒç´ æŒ‚ä»¶çª—å£
final widgetWindowId = await DesktopMultiWindow.createWindow(
  jsonEncode({
    'type': 'pixel_widget',
    'width': 200,
    'height': 200,
    'transparent': true,
  }),
);

// çª—å£é—´é€šä¿¡
DesktopMultiWindow.invokeMethod(
  mainWindowId,
  'updateGold',
  {'amount': 100},
);
```

**å·¥ä½œé‡**: 2-3 å¤©
- é›†æˆä¾èµ–åŒ…
- é‡æ„çª—å£ç®¡ç†æœåŠ¡
- å®ç°çª—å£åˆ›å»ºå’Œé”€æ¯é€»è¾‘

#### æ–¹æ¡ˆ B: bitsdojo_windowï¼ˆå¤‡é€‰ï¼‰

**ä¾èµ–åŒ…**: `bitsdojo_window: ^0.1.6`

**ä¼˜ç‚¹**:
- âœ… æ›´åº•å±‚çš„çª—å£æ§åˆ¶
- âœ… æ”¯æŒè‡ªå®šä¹‰æ ‡é¢˜æ 
- âœ… æ›´çµæ´»çš„çª—å£æ ·å¼

**ç¼ºç‚¹**:
- âŒ ä¸ç›´æ¥æ”¯æŒå¤šçª—å£
- âŒ éœ€è¦æ‰‹åŠ¨ç®¡ç†å¤šä¸ªè¿›ç¨‹

**ç»“è®º**: ä¸æ¨èç”¨äºå¤šçª—å£åœºæ™¯

---

## 2ï¸âƒ£ çª—å£ç‰¹æ•ˆ (Window Effects)

### éœ€æ±‚ 1: æ¯›ç»ç’ƒ/äºšå…‹åŠ›èƒŒæ™¯

**æŠ€æœ¯æ–¹æ¡ˆ**: `flutter_acrylic: ^1.1.4`

**æ”¯æŒçš„æ•ˆæœ**:
```dart
// Windows 11 äºšå…‹åŠ›æ•ˆæœ
await Window.setEffect(
  effect: WindowEffect.acrylic,
  color: Color(0xCC222222),  // åŠé€æ˜é»‘è‰²
);

// Windows 10 æ¯›ç»ç’ƒæ•ˆæœ
await Window.setEffect(
  effect: WindowEffect.aero,
  color: Color(0xCC222222),
);

// äº‘æ¯æ•ˆæœï¼ˆWindows 11ï¼‰
await Window.setEffect(
  effect: WindowEffect.mica,
  dark: true,
);
```

**æ€§èƒ½è¯„ä¼°**:
- âœ… GPU åŠ é€Ÿï¼Œæ€§èƒ½ä¼˜ç§€
- âœ… åŸç”Ÿ Windows API è°ƒç”¨
- âš ï¸ éœ€è¦ Windows 10 1809+ æˆ– Windows 11

**å®ç°ç¤ºä¾‹**:
```dart
class WindowEffectService {
  Future<void> applyStarRailStyle() async {
    if (Platform.isWindows) {
      // æ£€æŸ¥ Windows ç‰ˆæœ¬
      final version = await _getWindowsVersion();
      
      if (version >= 11) {
        // Windows 11: ä½¿ç”¨äº‘æ¯æ•ˆæœ
        await Window.setEffect(
          effect: WindowEffect.mica,
          dark: true,
        );
      } else {
        // Windows 10: ä½¿ç”¨äºšå…‹åŠ›æ•ˆæœ
        await Window.setEffect(
          effect: WindowEffect.acrylic,
          color: Color(0xCC1A1A2E),  // æ˜Ÿç©¹é“é“æ·±è“è‰²
        );
      }
    }
  }
}
```

**å·¥ä½œé‡**: 1-2 å¤©

### éœ€æ±‚ 2: é€æ˜ + é¼ æ ‡ç©¿é€çª—å£

**æŠ€æœ¯æ–¹æ¡ˆ**: `flutter_acrylic` + `win32`

**å®ç°æ­¥éª¤**:

1. **è®¾ç½®çª—å£é€æ˜**:
```dart
await Window.setEffect(
  effect: WindowEffect.transparent,
);
```

2. **è®¾ç½®é¼ æ ‡ç©¿é€**:
```dart
import 'package:win32/win32.dart';

void setMousePassThrough(int hwnd) {
  // è·å–å½“å‰çª—å£æ ·å¼
  final exStyle = GetWindowLongPtr(hwnd, GWL_EXSTYLE);
  
  // æ·»åŠ  WS_EX_TRANSPARENT å’Œ WS_EX_LAYERED
  SetWindowLongPtr(
    hwnd,
    GWL_EXSTYLE,
    exStyle | WS_EX_TRANSPARENT | WS_EX_LAYERED,
  );
}
```

3. **åªåœ¨å›¾æ¡ˆåŒºåŸŸå“åº”ç‚¹å‡»**:
```dart
// ä½¿ç”¨ HitTestBehavior.translucent
GestureDetector(
  behavior: HitTestBehavior.translucent,
  onTap: () {
    // åªæœ‰ç‚¹å‡»å›¾æ¡ˆæ—¶æ‰å“åº”
  },
  child: CustomPaint(
    painter: PixelCharacterPainter(),
  ),
)
```

**æ³¨æ„äº‹é¡¹**:
- âš ï¸ å®Œå…¨ç©¿é€åï¼Œçª—å£æ— æ³•æ‹–åŠ¨
- ğŸ’¡ è§£å†³æ–¹æ¡ˆï¼šä¿ç•™ä¸€ä¸ªå°çš„"æ‹–åŠ¨æ‰‹æŸ„"åŒºåŸŸ

**å·¥ä½œé‡**: 2-3 å¤©

---

## 3ï¸âƒ£ çŠ¶æ€å…±äº« (State Sync)

### å½“å‰æ¶æ„

**çŠ¶æ€ç®¡ç†**: `flutter_riverpod: ^2.4.9`

**é—®é¢˜**: Riverpod çš„ Provider åªåœ¨å•ä¸ª isolate å†…å…±äº«

### v3.0 æŒ‘æˆ˜

**åœºæ™¯**:
```
ç”¨æˆ·åœ¨ä¸»çª—å£è´­ä¹°é“å…· â†’ é‡‘å¸ -100
â†“
åƒç´ æŒ‚ä»¶éœ€è¦ç«‹å³æ›´æ–°é‡‘å¸æ˜¾ç¤º
```

**è¦æ±‚**: æ¯«ç§’çº§åŒæ­¥ï¼ˆ<100msï¼‰

### æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”

#### æ–¹æ¡ˆ A: MethodChannel é€šä¿¡ï¼ˆæ¨èï¼‰

**åŸç†**: ä½¿ç”¨ `desktop_multi_window` çš„å†…ç½®é€šä¿¡æœºåˆ¶

```dart
// ä¸»çª—å£ï¼šå‘é€æ›´æ–°
DesktopMultiWindow.invokeMethod(
  widgetWindowId,
  'updateGold',
  {'amount': profile.gold},
);

// åƒç´ æŒ‚ä»¶ï¼šæ¥æ”¶æ›´æ–°
DesktopMultiWindow.setMethodHandler((call, fromWindowId) async {
  if (call.method == 'updateGold') {
    final amount = call.arguments['amount'];
    ref.read(goldProvider.notifier).state = amount;
  }
});
```

**ä¼˜ç‚¹**:
- âœ… å»¶è¿Ÿä½ï¼ˆ<50msï¼‰
- âœ… ç±»å‹å®‰å…¨
- âœ… æ˜“äºè°ƒè¯•

**ç¼ºç‚¹**:
- âš ï¸ éœ€è¦æ‰‹åŠ¨åŒæ­¥æ¯ä¸ªçŠ¶æ€

**å·¥ä½œé‡**: 3-4 å¤©

#### æ–¹æ¡ˆ B: Hive æ•°æ®åº“ç›‘å¬

**åŸç†**: ä¸¤ä¸ªçª—å£ç›‘å¬åŒä¸€ä¸ª Hive Box

```dart
// ä¸»çª—å£ï¼šæ›´æ–°æ•°æ®
final profileBox = Hive.box<AdventurerProfile>('profile');
await profileBox.put('current', updatedProfile);

// åƒç´ æŒ‚ä»¶ï¼šç›‘å¬å˜åŒ–
profileBox.watch(key: 'current').listen((event) {
  final newProfile = event.value as AdventurerProfile;
  ref.read(profileProvider.notifier).state = newProfile;
});
```

**ä¼˜ç‚¹**:
- âœ… è‡ªåŠ¨åŒæ­¥
- âœ… æŒä¹…åŒ– + åŒæ­¥ä¸€ä½“

**ç¼ºç‚¹**:
- âŒ å»¶è¿Ÿè¾ƒé«˜ï¼ˆ100-200msï¼‰
- âŒ ç£ç›˜ I/O å¼€é”€

**å·¥ä½œé‡**: 2-3 å¤©

#### æ–¹æ¡ˆ C: å…±äº«å†…å­˜ï¼ˆé«˜çº§ï¼‰

**åŸç†**: ä½¿ç”¨ `ffi` + Windows å…±äº«å†…å­˜ API

**ä¼˜ç‚¹**:
- âœ… å»¶è¿Ÿæä½ï¼ˆ<10msï¼‰
- âœ… é›¶åºåˆ—åŒ–å¼€é”€

**ç¼ºç‚¹**:
- âŒ å®ç°å¤æ‚
- âŒ éœ€è¦æ‰‹åŠ¨ç®¡ç†å†…å­˜
- âŒ ä¸è·¨å¹³å°

**ç»“è®º**: ä¸æ¨èï¼ˆè¿‡åº¦è®¾è®¡ï¼‰

### æ¨èæ–¹æ¡ˆ

**æ··åˆæ–¹æ¡ˆ**: MethodChannel + Hive

```dart
class CrossWindowStateManager {
  // å®æ—¶çŠ¶æ€ï¼šä½¿ç”¨ MethodChannel
  void syncRealtimeState(String key, dynamic value) {
    DesktopMultiWindow.invokeMethod(
      targetWindowId,
      'updateState',
      {'key': key, 'value': value},
    );
  }
  
  // æŒä¹…åŒ–çŠ¶æ€ï¼šä½¿ç”¨ Hive
  Future<void> persistState(String key, dynamic value) async {
    await Hive.box('state').put(key, value);
  }
}
```

**å·¥ä½œé‡**: 4-5 å¤©

---

## 4ï¸âƒ£ æ•°æ®æŒä¹…åŒ–

### å½“å‰æ¶æ„

**å­˜å‚¨æ–¹æ¡ˆ**: `hive: ^2.2.3` + `hive_flutter: ^1.1.0`

**å­˜å‚¨ä½ç½®**:
```
Windows: C:\Users\[ç”¨æˆ·å]\AppData\Roaming\work_hours_timer\
```

**æ•°æ®ç»“æ„**:
```dart
// å†’é™©è€…æ¡£æ¡ˆ
Box<AdventurerProfile> profileBox

// å·¥ä½œè®°å½•
Box<WorkRecord> recordsBox

// é¡¹ç›®æ•°æ®
Box<Project> projectsBox

// è®¾ç½®
Box<WorkSettings> settingsBox
```

### v3.0 å…¼å®¹æ€§

**å¥½æ¶ˆæ¯**: âœ… **æ— éœ€è¿ç§»ï¼Œå®Œå…¨å…¼å®¹**

**åŸå› **:
1. Hive æ”¯æŒå¤šè¿›ç¨‹è®¿é—®ï¼ˆéœ€è¦åŠ é”ï¼‰
2. æ•°æ®æ¨¡å‹æ— éœ€æ”¹å˜
3. åªéœ€åœ¨æ¯ä¸ªçª—å£ä¸­æ‰“å¼€ç›¸åŒçš„ Box

**å®ç°ç¤ºä¾‹**:
```dart
// ä¸»çª—å£å’Œåƒç´ æŒ‚ä»¶éƒ½æ‰§è¡Œ
await Hive.initFlutter('work_hours_timer');
final profileBox = await Hive.openBox<AdventurerProfile>('profile');
```

**æ³¨æ„äº‹é¡¹**:
- âš ï¸ éœ€è¦å¤„ç†å¹¶å‘å†™å…¥ï¼ˆä½¿ç”¨ `synchronized` åŒ…ï¼‰
- ğŸ’¡ å»ºè®®ï¼šä¸»çª—å£è´Ÿè´£å†™å…¥ï¼Œåƒç´ æŒ‚ä»¶åªè¯»

**å·¥ä½œé‡**: 0.5 å¤©ï¼ˆæ·»åŠ å¹¶å‘æ§åˆ¶ï¼‰

---

## 5ï¸âƒ£ å¹³å°é™åˆ¶

### Windows å¹³å°è¯„ä¼°

**ä¼˜åŠ¿**:
- âœ… `flutter_acrylic` å®Œç¾æ”¯æŒ
- âœ… `desktop_multi_window` ç¨³å®š
- âœ… Win32 API ä¸°å¯Œ
- âœ… ç”¨æˆ·ç¾¤ä½“å¤§

**æ¨è**: âœ… **v3.0 ä¸“æ³¨ Windows å¹³å°**

### macOS å¹³å°è¯„ä¼°

**æŒ‘æˆ˜**:
- âš ï¸ çª—å£åœé æœºåˆ¶ä¸åŒï¼ˆDock vs Taskbarï¼‰
- âš ï¸ æ¯›ç»ç’ƒæ•ˆæœ API ä¸åŒï¼ˆNSVisualEffectViewï¼‰
- âš ï¸ æƒé™ç®¡ç†æ›´ä¸¥æ ¼

**å·¥ä½œé‡**: +2 å‘¨

**å»ºè®®**: âŒ v3.0 ä¸æ”¯æŒï¼Œv3.1 å†è€ƒè™‘

### Linux å¹³å°è¯„ä¼°

**æŒ‘æˆ˜**:
- âŒ `flutter_acrylic` æ”¯æŒæœ‰é™
- âŒ çª—å£ç®¡ç†å™¨å·®å¼‚å¤§ï¼ˆGNOME/KDE/i3ï¼‰
- âŒ ç”¨æˆ·ç¾¤ä½“å°

**å»ºè®®**: âŒ ä¸æ”¯æŒ

---

## ğŸ“Š æŠ€æœ¯æ ˆå¯¹æ¯”

### å½“å‰æŠ€æœ¯æ ˆ (v1.0-v1.4.0)

```yaml
dependencies:
  flutter_riverpod: ^2.4.9      # çŠ¶æ€ç®¡ç†
  hive: ^2.2.3                  # æœ¬åœ°å­˜å‚¨
  window_manager: ^0.3.7        # å•çª—å£ç®¡ç†
  audioplayers: ^5.2.1          # éŸ³æ•ˆ
  google_fonts: ^6.1.0          # å­—ä½“
  flutter_animate: ^4.5.0       # åŠ¨ç”»
```

### v3.0 æ–°å¢ä¾èµ–

```yaml
dependencies:
  # å¤šçª—å£ç®¡ç†
  desktop_multi_window: ^0.2.0
  
  # çª—å£ç‰¹æ•ˆ
  flutter_acrylic: ^1.1.4
  
  # åº•å±‚ Windows API
  win32: ^5.0.0
  ffi: ^2.1.0
  
  # å¹¶å‘æ§åˆ¶
  synchronized: ^3.1.0
  
  # è·¨çª—å£é€šä¿¡
  # (desktop_multi_window å·²åŒ…å«)
```

**ä¾èµ–åŒ…æ€»æ•°**: 6 ä¸ªæ–°å¢

---

## ğŸ¯ å®ç°è·¯çº¿å›¾

### Phase 1: åŸºç¡€æ¶æ„ï¼ˆ1 å‘¨ï¼‰

**ä»»åŠ¡**:
1. é›†æˆ `desktop_multi_window`
2. é‡æ„çª—å£ç®¡ç†æœåŠ¡
3. å®ç°çª—å£åˆ›å»ºå’Œé”€æ¯
4. æµ‹è¯•å¤šçª—å£ç¨³å®šæ€§

**äº¤ä»˜ç‰©**:
- `MultiWindowManager` æœåŠ¡
- ä¸»çª—å£ + åƒç´ æŒ‚ä»¶åŒæ—¶è¿è¡Œ

### Phase 2: çª—å£ç‰¹æ•ˆï¼ˆ1 å‘¨ï¼‰

**ä»»åŠ¡**:
1. é›†æˆ `flutter_acrylic`
2. å®ç°æ¯›ç»ç’ƒ/äºšå…‹åŠ›æ•ˆæœ
3. å®ç°é€æ˜ + é¼ æ ‡ç©¿é€
4. ä¼˜åŒ–æ€§èƒ½

**äº¤ä»˜ç‰©**:
- `WindowEffectService` æœåŠ¡
- æ˜Ÿç©¹é“é“é£æ ¼èƒŒæ™¯

### Phase 3: çŠ¶æ€åŒæ­¥ï¼ˆ1 å‘¨ï¼‰

**ä»»åŠ¡**:
1. è®¾è®¡è·¨çª—å£é€šä¿¡åè®®
2. å®ç° MethodChannel é€šä¿¡
3. é›†æˆ Hive ç›‘å¬
4. æµ‹è¯•åŒæ­¥å»¶è¿Ÿ

**äº¤ä»˜ç‰©**:
- `CrossWindowStateManager` æœåŠ¡
- æ¯«ç§’çº§çŠ¶æ€åŒæ­¥

### Phase 4: UI é‡æ„ï¼ˆ1 å‘¨ï¼‰

**ä»»åŠ¡**:
1. è®¾è®¡æ˜Ÿç©¹é“é“é£æ ¼ UI
2. å®ç°ä¸»çª—å£ç•Œé¢
3. å®ç°åƒç´ æŒ‚ä»¶ç•Œé¢
4. åŠ¨ç”»å’Œäº¤äº’

**äº¤ä»˜ç‰©**:
- å®Œæ•´çš„ v3.0 UI

---

## ğŸ’° å·¥ä½œé‡ä¼°ç®—

### å¼€å‘æ—¶é—´

| é˜¶æ®µ | ä»»åŠ¡ | å·¥ä½œé‡ | é£é™© |
|------|------|--------|------|
| Phase 1 | å¤šçª—å£æ¶æ„ | 40h | ä¸­ |
| Phase 2 | çª—å£ç‰¹æ•ˆ | 30h | ä½ |
| Phase 3 | çŠ¶æ€åŒæ­¥ | 35h | é«˜ |
| Phase 4 | UI é‡æ„ | 40h | ä½ |
| æµ‹è¯• & è°ƒè¯• | å…¨é¢æµ‹è¯• | 20h | ä¸­ |
| **æ€»è®¡** | | **165h** | |

**æ—¥å†æ—¶é—´**: 3-4 å‘¨ï¼ˆå‡è®¾æ¯å¤© 5-6 å°æ—¶ï¼‰

### é£é™©è¯„ä¼°

**é«˜é£é™©**:
- âš ï¸ çŠ¶æ€åŒæ­¥å»¶è¿Ÿå¯èƒ½è¶…è¿‡é¢„æœŸ
- âš ï¸ å¤šçª—å£å†…å­˜å ç”¨å¯èƒ½è¿‡é«˜

**ä¸­é£é™©**:
- âš ï¸ `desktop_multi_window` å¯èƒ½æœ‰æœªçŸ¥ bug
- âš ï¸ çª—å£ç‰¹æ•ˆåœ¨æŸäº› Windows ç‰ˆæœ¬å¯èƒ½ä¸æ”¯æŒ

**ä½é£é™©**:
- âœ… UI é‡æ„ï¼ˆå·²æœ‰ v1.2.0 ç»éªŒï¼‰
- âœ… æ•°æ®æŒä¹…åŒ–ï¼ˆHive æˆç†Ÿç¨³å®šï¼‰

---

## ğŸ¨ UI è®¾è®¡å»ºè®®

### ä¸»çª—å£ï¼ˆå³ä¾§åœé ï¼‰

**å°ºå¯¸**: 400x800

**å¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [ç”¨æˆ·å¤´åƒ] Lv.15       â”‚  â† é¡¶éƒ¨çŠ¶æ€æ 
â”‚  ğŸ’° 1,234  â­ 567/1500  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š ç»Ÿè®¡                â”‚  â† å¯¼èˆªèœå•
â”‚  ğŸ¯ æˆå°±                â”‚
â”‚  ğŸ›’ å•†åº—                â”‚
â”‚  ğŸ“ é¡¹ç›®                â”‚
â”‚  âš™ï¸ è®¾ç½®                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚  â† å†…å®¹åŒºåŸŸ
â”‚  [åŠ¨æ€å†…å®¹]             â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹æ•ˆ**:
- æ¯›ç»ç’ƒèƒŒæ™¯ï¼ˆäºšå…‹åŠ›æ•ˆæœï¼‰
- æ·±è“è‰²ä¸»é¢˜ï¼ˆ#1A1A2Eï¼‰
- é‡‘è‰²å¼ºè°ƒè‰²ï¼ˆ#FFD700ï¼‰

### åƒç´ æŒ‚ä»¶ï¼ˆå³ä¸‹è§’ï¼‰

**å°ºå¯¸**: 200x200

**å†…å®¹**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸƒâ€â™‚ï¸       â”‚  â† åƒç´ å°äºº
â”‚             â”‚
â”‚  ğŸ’° 1,234   â”‚  â† é‡‘å¸æ˜¾ç¤º
â”‚  â±ï¸ 02:34   â”‚  â† è®¡æ—¶å™¨
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç‰¹æ•ˆ**:
- å®Œå…¨é€æ˜èƒŒæ™¯
- åªæ˜¾ç¤ºåƒç´ å›¾æ¡ˆ
- é¼ æ ‡ç©¿é€ï¼ˆé™¤äº†å›¾æ¡ˆåŒºåŸŸï¼‰

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### çª—å£é€šä¿¡åè®®

**æ¶ˆæ¯æ ¼å¼**:
```dart
class WindowMessage {
  final String type;      // 'updateGold', 'updateExp', 'startWork'
  final Map<String, dynamic> data;
  final int timestamp;
}
```

**ç¤ºä¾‹**:
```dart
// ä¸»çª—å£ â†’ åƒç´ æŒ‚ä»¶
{
  'type': 'updateGold',
  'data': {'amount': 1234},
  'timestamp': 1709020800000
}

// åƒç´ æŒ‚ä»¶ â†’ ä¸»çª—å£
{
  'type': 'requestFullView',
  'data': {},
  'timestamp': 1709020801000
}
```

### æ€§èƒ½ä¼˜åŒ–

**ç›®æ ‡**:
- ä¸»çª—å£ FPS: 60
- åƒç´ æŒ‚ä»¶ FPS: 30ï¼ˆçœç”µï¼‰
- çŠ¶æ€åŒæ­¥å»¶è¿Ÿ: <100ms
- å†…å­˜å ç”¨: <200MBï¼ˆä¸¤ä¸ªçª—å£æ€»å’Œï¼‰

**ä¼˜åŒ–ç­–ç•¥**:
1. åƒç´ æŒ‚ä»¶ä½¿ç”¨ä½åˆ·æ–°ç‡
2. åªåŒæ­¥å¿…è¦çš„çŠ¶æ€
3. ä½¿ç”¨ `RepaintBoundary` å‡å°‘é‡ç»˜
4. æ‡’åŠ è½½éå…³é”®èµ„æº

---

## âœ… å¯è¡Œæ€§ç»“è®º

### æŠ€æœ¯å¯è¡Œæ€§: âœ… é«˜

**ç†ç”±**:
1. æ‰€æœ‰æ ¸å¿ƒæŠ€æœ¯éƒ½æœ‰æˆç†Ÿçš„ Flutter åŒ…æ”¯æŒ
2. Windows å¹³å°æ”¯æŒå®Œå–„
3. å½“å‰æ¶æ„å¯å¹³æ»‘è¿ç§»

### å·¥ä½œé‡: âš ï¸ ä¸­ç­‰

**é¢„ä¼°**: 3-4 å‘¨ï¼ˆ165 å°æ—¶ï¼‰

**å»ºè®®**:
- åˆ†é˜¶æ®µå¼€å‘ï¼Œæ¯ä¸ª Phase ç‹¬ç«‹æµ‹è¯•
- å…ˆå®ç°æ ¸å¿ƒåŠŸèƒ½ï¼Œå†ä¼˜åŒ– UI
- ä¿ç•™ v1.4.0 ä½œä¸ºå¤‡ç”¨ç‰ˆæœ¬

### é£é™©: âš ï¸ ä¸­ç­‰

**ä¸»è¦é£é™©**:
1. çŠ¶æ€åŒæ­¥å»¶è¿Ÿ
2. å¤šçª—å£å†…å­˜å ç”¨
3. ç”¨æˆ·å­¦ä¹ æˆæœ¬

**ç¼“è§£æªæ–½**:
1. æå‰åšæ€§èƒ½æµ‹è¯•
2. æä¾›"å•çª—å£æ¨¡å¼"ä½œä¸ºå¤‡é€‰
3. åˆ¶ä½œè¯¦ç»†çš„ç”¨æˆ·æŒ‡å—

---

## ğŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³è¡ŒåŠ¨

1. **æŠ€æœ¯éªŒè¯** (1-2 å¤©)
   - åˆ›å»º `desktop_multi_window` æ¼”ç¤ºé¡¹ç›®
   - æµ‹è¯•çª—å£ç‰¹æ•ˆæ€§èƒ½
   - éªŒè¯çŠ¶æ€åŒæ­¥å»¶è¿Ÿ

2. **è®¾è®¡è¯„å®¡** (1 å¤©)
   - ç»˜åˆ¶è¯¦ç»†çš„ UI è®¾è®¡ç¨¿
   - ç¡®å®šäº¤äº’æµç¨‹
   - ç”¨æˆ·ä½“éªŒè¯„ä¼°

3. **å†³ç­–ç‚¹**
   - âœ… å¦‚æœæŠ€æœ¯éªŒè¯é€šè¿‡ â†’ å¼€å§‹ Phase 1
   - âŒ å¦‚æœæœ‰é‡å¤§é—®é¢˜ â†’ è°ƒæ•´æ–¹æ¡ˆæˆ–æ¨è¿Ÿ v3.0

### å»ºè®®

**æ¨è**: âœ… **å¼€å§‹ v3.0 å¼€å‘**

**ç†ç”±**:
- æŠ€æœ¯æ ˆæˆç†Ÿ
- å·¥ä½œé‡å¯æ§
- ç”¨æˆ·ä½“éªŒæå‡æ˜¾è‘—

**å‰ææ¡ä»¶**:
- v1.4.0 çš„ ParentDataWidget é”™è¯¯å·²ä¿®å¤ âœ…
- æœ‰ 3-4 å‘¨çš„å¼€å‘æ—¶é—´
- æ„¿æ„ä¸“æ³¨ Windows å¹³å°

---

## ğŸ“š å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£

- [desktop_multi_window](https://pub.dev/packages/desktop_multi_window)
- [flutter_acrylic](https://pub.dev/packages/flutter_acrylic)
- [window_manager](https://pub.dev/packages/window_manager)

### ç¤ºä¾‹é¡¹ç›®

- [Biyi (æ¯”è¯‘)](https://github.com/biyidev/biyi) - ä½¿ç”¨ `desktop_multi_window` çš„ç¿»è¯‘è½¯ä»¶
- [Fluent UI](https://github.com/bdlukaa/fluent_ui) - Windows 11 é£æ ¼ UI åº“

### æŠ€æœ¯æ–‡ç« 

- [Flutter æ¡Œé¢å¤šçª—å£å¼€å‘æŒ‡å—](https://medium.com/@flutter/multi-window-desktop-apps-with-flutter)
- [Windows äºšå…‹åŠ›æ•ˆæœå®ç°](https://docs.microsoft.com/en-us/windows/apps/design/style/acrylic)

---

**åˆ›å»ºæ—¥æœŸ**: 2026-02-26  
**çŠ¶æ€**: âœ… è¯„ä¼°å®Œæˆ  
**å»ºè®®**: å¼€å§‹æŠ€æœ¯éªŒè¯ï¼Œç„¶åå¯åŠ¨ Phase 1

---

## ğŸ™‹ FAQ

**Q: v3.0 ä¼šå½±å“ v1.4.0 çš„åŠŸèƒ½å—ï¼Ÿ**  
A: ä¸ä¼šã€‚v3.0 æ˜¯å…¨æ–°çš„çª—å£æ¶æ„ï¼Œv1.4.0 çš„æ‰€æœ‰åŠŸèƒ½éƒ½ä¼šä¿ç•™ã€‚

**Q: ç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸ä½¿ç”¨å¤šçª—å£æ¨¡å¼å—ï¼Ÿ**  
A: å¯ä»¥ã€‚æˆ‘ä»¬ä¼šæä¾›"å•çª—å£æ¨¡å¼"ä½œä¸ºå¤‡é€‰ã€‚

**Q: macOS ç”¨æˆ·æ€ä¹ˆåŠï¼Ÿ**  
A: v3.0 ä¸“æ³¨ Windowsï¼ŒmacOS æ”¯æŒè®¡åˆ’åœ¨ v3.1ã€‚

**Q: æ€§èƒ½ä¼šå˜å·®å—ï¼Ÿ**  
A: å¤šçª—å£ä¼šå¢åŠ å†…å­˜å ç”¨ï¼ˆçº¦ +50MBï¼‰ï¼Œä½† FPS ä¸ä¼šé™ä½ã€‚

**Q: å¼€å‘å‘¨æœŸèƒ½ç¼©çŸ­å—ï¼Ÿ**  
A: å¯ä»¥ã€‚å¦‚æœåªå®ç°æ ¸å¿ƒåŠŸèƒ½ï¼ˆä¸åš UI ç¾åŒ–ï¼‰ï¼Œå¯ä»¥ç¼©çŸ­åˆ° 2 å‘¨ã€‚

---

**ç¥å¼€å‘é¡ºåˆ©ï¼ğŸ‰**
