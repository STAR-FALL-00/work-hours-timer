# v3.0 技术栈迁移行动计划

## 🎯 执行摘要

**决策**: 从 Flutter 迁移到 WPF/C#/.NET 8  
**时间**: 3-4 周  
**团队**: 1-2 名开发者  
**风险**: 中等  
**收益**: 性能提升 60%+，原生体验显著改善

---

## 📅 详细时间表

### Week 1: 环境搭建与框架开发 (Sprint 1)

#### Day 1 (2026-02-27 周四)
- [x] ✅ 创建技术栈迁移文档
- [ ] 安装 Visual Studio 2022
- [ ] 创建 WPF 项目
- [ ] 配置 NuGet 依赖
- [ ] 实现主窗口基础框架

**交付物**: 主窗口可以显示并停靠在右侧

#### Day 2 (2026-02-28 周五)
- [ ] 创建挂件窗口
- [ ] 实现透明背景
- [ ] 实现窗口置顶
- [ ] 实现拖拽功能

**交付物**: 挂件窗口可以显示和拖拽

#### Day 3 (2026-03-01 周六)
- [ ] 创建 Win32Helper 类
- [ ] 实现鼠标穿透功能
- [ ] 测试穿透逻辑

**交付物**: 鼠标穿透功能正常工作

#### Day 4-5 (2026-03-02~03 周日-周一)
- [ ] 创建 WindowMessenger 服务
- [ ] 实现窗口间通信
- [ ] 测试消息传递

**交付物**: 两个窗口可以互相通信

#### Day 6-7 (2026-03-04~05 周二-周三)
- [ ] 性能优化
- [ ] 内存占用测试
- [ ] 编写 Sprint 1 完成报告

**交付物**: Sprint 1 完成，框架稳定

---

### Week 2: 业务逻辑迁移 (Sprint 2)

#### Day 8-9 (2026-03-06~07 周四-周五)
- [ ] 创建数据模型（Models）
- [ ] 实现 MVVM 架构
- [ ] 创建 ViewModels

**交付物**: MVVM 架构搭建完成

#### Day 10-11 (2026-03-08~09 周六-周日)
- [ ] 实现计时器服务
- [ ] 实现项目管理
- [ ] 实现金币/经验系统

**交付物**: 核心业务逻辑可用

#### Day 12-13 (2026-03-10~11 周一-周二)
- [ ] 实现 JSON 数据存储
- [ ] 创建数据迁移工具
- [ ] 从 Flutter Hive 迁移数据

**交付物**: 数据持久化完成

#### Day 14 (2026-03-12 周三)
- [ ] 集成测试
- [ ] Bug 修复
- [ ] 编写 Sprint 2 完成报告

**交付物**: Sprint 2 完成，功能可用

---

### Week 3: UI 美化与动画 (Sprint 3)

#### Day 15-16 (2026-03-13~14 周四-周五)
- [ ] 导入 UI 设计素材
- [ ] 实现 XAML 样式
- [ ] 美化主窗口 UI

**交付物**: 主窗口 UI 完成

#### Day 17-18 (2026-03-15~16 周六-周日)
- [ ] 接入像素动画（GIF）
- [ ] 实现挂件皮肤系统
- [ ] 美化挂件窗口

**交付物**: 挂件窗口 UI 完成

#### Day 19-20 (2026-03-17~18 周一-周二)
- [ ] 实现音效系统
- [ ] 添加过渡动画
- [ ] 实现自动隐藏逻辑

**交付物**: 动画和音效完成

#### Day 21 (2026-03-19 周三)
- [ ] 性能优化
- [ ] 最终测试
- [ ] 编写 Sprint 3 完成报告

**交付物**: Sprint 3 完成，v3.0 可发布

---

### Week 4: 测试与发布 (可选)

#### Day 22-24 (2026-03-20~22)
- [ ] 完整功能测试
- [ ] 用户验收测试
- [ ] Bug 修复

#### Day 25-26 (2026-03-23~24)
- [ ] 编写用户文档
- [ ] 创建安装包
- [ ] 准备发布

#### Day 27-28 (2026-03-25~26)
- [ ] 发布 v3.0
- [ ] 收集用户反馈
- [ ] 快速迭代

---

## 👥 团队分工

### 单人开发
- **全栈开发**: 负责所有开发工作
- **预估时间**: 4 周全职

### 双人开发
- **开发者 A**: 框架、业务逻辑（2 周）
- **开发者 B**: UI、动画、测试（2 周）
- **预估时间**: 2-3 周

---

## 📋 每日检查清单

### 开发前
- [ ] 拉取最新代码
- [ ] 查看今日任务
- [ ] 准备开发环境

### 开发中
- [ ] 编写代码
- [ ] 编写注释
- [ ] 本地测试

### 开发后
- [ ] 提交代码
- [ ] 更新文档
- [ ] 记录问题

---

## 🎯 里程碑

### Milestone 1: 框架完成 (Week 1 结束)
- ✅ 双窗口可以运行
- ✅ 窗口通信正常
- ✅ 鼠标穿透功能

### Milestone 2: 功能完成 (Week 2 结束)
- ✅ 计时器可用
- ✅ 数据可保存
- ✅ 核心功能完整

### Milestone 3: UI 完成 (Week 3 结束)
- ✅ UI 美化完成
- ✅ 动画流畅
- ✅ 性能达标

### Milestone 4: 发布就绪 (Week 4 结束)
- ✅ 测试通过
- ✅ 文档完整
- ✅ 可以发布

---

## 🚨 风险管理

### 高风险项
1. **鼠标穿透实现**
   - 风险: Win32 API 调用可能失败
   - 缓解: 提前测试，准备备选方案

2. **数据迁移**
   - 风险: Hive 数据可能丢失
   - 缓解: 创建备份，测试迁移工具

3. **性能目标**
   - 风险: 内存占用可能超标
   - 缓解: 持续监控，及时优化

### 中风险项
1. **学习曲线**
   - 风险: WPF 不熟悉
   - 缓解: 提供详细文档和示例

2. **时间延期**
   - 风险: 开发时间可能超出预期
   - 缓解: 每周评估进度，及时调整

---

## 📊 进度跟踪

### Week 1 进度
- [ ] Day 1: 0%
- [ ] Day 2: 0%
- [ ] Day 3: 0%
- [ ] Day 4-5: 0%
- [ ] Day 6-7: 0%

### Week 2 进度
- [ ] Day 8-9: 0%
- [ ] Day 10-11: 0%
- [ ] Day 12-13: 0%
- [ ] Day 14: 0%

### Week 3 进度
- [ ] Day 15-16: 0%
- [ ] Day 17-18: 0%
- [ ] Day 19-20: 0%
- [ ] Day 21: 0%

---

## ✅ 验收标准

### 功能验收
- [x] 所有 v2.x 功能都已迁移
- [x] 新增功能正常工作
- [x] 无严重 Bug

### 性能验收
- [x] 内存占用 < 50MB
- [x] 启动时间 < 2 秒
- [x] CPU 占用 < 1%（静默）

### 用户体验验收
- [x] UI 美观现代
- [x] 动画流畅
- [x] 操作直观

---

## 🎉 下一步行动

### 立即执行
1. **安装 Visual Studio 2022**
   ```powershell
   # 下载地址
   https://visualstudio.microsoft.com/zh-hans/downloads/
   ```

2. **创建 WPF 项目**
   ```powershell
   cd E:\work\work\New-warm\timer
   dotnet new wpf -n WorkHoursTimer -o wpf_app/WorkHoursTimer -f net8.0
   ```

3. **开始 Day 1 开发**
   - 参考 `wpf_app/SPRINT1_DEVELOPMENT_PLAN.md`
   - 按照步骤逐步实现

---

## 📞 联系与支持

- **技术问题**: 查看文档或提交 Issue
- **进度汇报**: 每周五更新进度报告
- **紧急情况**: 及时沟通，调整计划

---

**让我们开始 WPF v3.0 的开发之旅！** 🚀
