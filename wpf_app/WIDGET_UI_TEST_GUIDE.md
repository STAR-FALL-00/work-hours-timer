# 🧪 挂件 UI 测试指南

**测试时间**: 2026-02-28  
**版本**: Phase 1  
**状态**: 准备测试

---

## 🚀 快速启动

### 方法 1: 使用批处理文件
```bash
cd wpf_app
.\build-and-run.bat
```

### 方法 2: 使用命令行
```bash
cd wpf_app/WorkHoursTimer
dotnet run
```

---

## ✅ 测试清单

### 1. 基础功能测试

#### 窗口显示
- [ ] 主窗口显示在屏幕右侧
- [ ] 挂件窗口显示在右下角
- [ ] 两个窗口都正常显示

#### 挂件外观
- [ ] 挂件背景为深蓝色半透明
- [ ] 边框为金色
- [ ] 有阴影效果
- [ ] 圆角显示正常

---

### 2. 金币动画测试

#### 金币 GIF
- [ ] 金币图标显示
- [ ] 金币旋转动画播放
- [ ] 动画循环播放
- [ ] 图像清晰（像素风格）

**预期效果**:
- 金币应该持续旋转
- 图像不应该模糊
- 大小约 20x20 像素

---

### 3. 勇者伐魔模式测试

#### 切换到勇者伐魔模式
1. 右键点击挂件
2. 选择"切换皮肤" → "勇者伐魔"

#### 检查项
- [ ] 显示 🗡️ 勇者 Emoji
- [ ] 显示 👹 Boss Emoji
- [ ] 显示 ⚔️ VS 图标
- [ ] Boss 血条显示（红色）
- [ ] 血条显示 "Boss HP: 100%"
- [ ] 计时器显示 "00:00:00"（金色）
- [ ] 金币图标和数字显示
- [ ] 经验 ⭐ 图标和数字显示

#### 开始工作测试
1. 在主窗口点击"开始工作"
2. 观察挂件变化

**预期效果**:
- [ ] 计时器开始计数
- [ ] Boss 血条逐渐减少
- [ ] 金币数字增加
- [ ] 经验数字增加

---

### 4. 跑酷猫咪模式测试

#### 切换到跑酷猫咪模式
1. 右键点击挂件
2. 选择"切换皮肤" → "跑酷猫咪"

#### 检查项
- [ ] 显示 🐱 猫咪 Emoji
- [ ] 显示进度条（蓝色）
- [ ] 显示里程碑标记（0h, 4h, 8h）
- [ ] 计时器显示 "00:00:00"（蓝色）
- [ ] 金币图标和数字显示（居中）

#### 开始工作测试
1. 在主窗口点击"开始工作"
2. 观察挂件变化

**预期效果**:
- [ ] 计时器开始计数
- [ ] 进度条逐渐填充
- [ ] 金币数字增加

---

### 5. 交互功能测试

#### 鼠标穿透
- [ ] 鼠标移开后，挂件变为穿透模式
- [ ] 可以点击挂件下方的内容
- [ ] 边框变为灰色

#### 鼠标交互
- [ ] 鼠标移入后，挂件可交互
- [ ] 边框变为金色
- [ ] 可以拖拽挂件

#### 右键菜单
- [ ] 右键点击显示菜单
- [ ] "切换皮肤"子菜单正常
- [ ] "关闭挂件"功能正常
- [ ] "置顶"切换正常

---

### 6. 数据同步测试

#### 主窗口 → 挂件
1. 在主窗口开始工作
2. 观察挂件是否同步更新

**检查项**:
- [ ] 挂件计时器与主窗口同步
- [ ] 金币数字正确
- [ ] 经验数字正确
- [ ] 血条/进度条正确

#### 停止工作
1. 在主窗口停止工作
2. 观察挂件变化

**预期效果**:
- [ ] 计时器重置为 "00:00:00"
- [ ] Boss 血条重置为 100%
- [ ] 进度条重置为 0%

---

### 7. 视觉效果测试

#### 颜色检查
- [ ] 背景: 深蓝色半透明
- [ ] 边框: 金色（交互时）/ 灰色（穿透时）
- [ ] 计时器: 金色（Boss 模式）/ 蓝色（Cat 模式）
- [ ] Boss 血条: 红色
- [ ] 进度条: 蓝色
- [ ] 金币数字: 金色
- [ ] 经验数字: 蓝色

#### 布局检查
- [ ] 元素对齐正确
- [ ] 间距合理
- [ ] 文字清晰可读
- [ ] 图标大小合适

---

## 🐛 已知问题

### 可能的问题
1. **金币 GIF 不显示**
   - 检查文件路径: `Assets/Images/UI/coin_spin.gif`
   - 检查 Build Action 是否为 Resource

2. **血条/进度条不显示**
   - 检查 PercentToWidthConverter 是否正确
   - 检查数据绑定是否正常

3. **皮肤切换无效**
   - 检查 CurrentSkin 属性是否更新
   - 检查 DataTrigger 是否正确

---

## 📊 性能测试

### CPU 使用率
- [ ] 空闲时 CPU 使用率 < 1%
- [ ] 工作时 CPU 使用率 < 5%
- [ ] GIF 动画不影响性能

### 内存使用
- [ ] 启动后内存 < 100MB
- [ ] 长时间运行内存稳定
- [ ] 无内存泄漏

---

## 🎯 测试场景

### 场景 1: 短时间工作
1. 开始工作
2. 工作 5 分钟
3. 停止工作

**预期**:
- Boss 血量减少约 1%
- 进度条填充约 1%
- 金币约 8-10

### 场景 2: 长时间工作
1. 开始工作
2. 工作 1 小时
3. 观察变化

**预期**:
- Boss 血量减少约 12.5%
- 进度条填充约 12.5%
- 金币约 100

### 场景 3: 皮肤切换
1. 开始工作（Boss 模式）
2. 工作 10 分钟
3. 切换到 Cat 模式
4. 继续工作 10 分钟
5. 切换回 Boss 模式

**预期**:
- 数据保持一致
- 切换流畅
- 无数据丢失

---

## 📸 截图清单

建议截图保存：
- [ ] 勇者伐魔模式（初始状态）
- [ ] 勇者伐魔模式（工作中）
- [ ] 跑酷猫咪模式（初始状态）
- [ ] 跑酷猫咪模式（工作中）
- [ ] 右键菜单
- [ ] 金币动画（GIF）

---

## ✅ 测试通过标准

### 必须通过
- ✅ 应用正常启动
- ✅ 挂件正常显示
- ✅ 金币 GIF 正常播放
- ✅ 皮肤切换正常
- ✅ 计时器同步正常
- ✅ 鼠标穿透正常

### 建议通过
- ✅ 血条/进度条动画流畅
- ✅ 数据显示准确
- ✅ 视觉效果美观
- ✅ 性能表现良好

---

## 🔧 调试技巧

### 查看日志
```bash
# 在 Visual Studio 中查看输出窗口
# 或在命令行中运行查看控制台输出
dotnet run
```

### 检查数据绑定
- 在 WidgetViewModel 中添加断点
- 观察属性值变化
- 检查消息接收是否正常

### 检查 GIF 加载
- 确认文件存在: `Assets/Images/UI/coin_spin.gif`
- 检查 Pack URI 格式
- 查看 XamlAnimatedGif 是否正确加载

---

## 📝 测试报告模板

```markdown
## 测试报告

**测试日期**: 2026-02-28
**测试人员**: [你的名字]
**测试版本**: Phase 1

### 测试结果
- 基础功能: ✅ / ❌
- 金币动画: ✅ / ❌
- 勇者伐魔模式: ✅ / ❌
- 跑酷猫咪模式: ✅ / ❌
- 交互功能: ✅ / ❌
- 数据同步: ✅ / ❌
- 视觉效果: ✅ / ❌

### 发现的问题
1. [问题描述]
2. [问题描述]

### 建议改进
1. [改进建议]
2. [改进建议]

### 总体评价
[你的评价]
```

---

**创建时间**: 2026-02-28  
**维护者**: Kiro AI Assistant  
**状态**: 准备测试

---

**下一步**: 运行应用，按照清单逐项测试！

